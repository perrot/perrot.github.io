<!--
http://www.w3schools.com/bootstrap/bootstrap_pager.asp
http://stackoverflow.com/questions/1497481/javascript-password-generator
http://stackoverflow.com/questions/948172/password-strength-meter
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>HOW STRENGTH IS MY PASSWORD?</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../tool-css/bootstrap.min.css">
  <script src="../tool-js/jquery.min.js"></script>
  <script src="../tool-js/bootstrap.min.js"></script>
  <script>
  function scorePassword(pass) {
    var score = 0;
    if (!pass)
        return score;

    // award every unique letter until 5 repetitions
    var letters = new Object();
    for (var i=0; i<pass.length; i++) {
        letters[pass[i]] = (letters[pass[i]] || 0) + 1;
        score += 5.0 / letters[pass[i]];
    }

    // bonus points for mixing it up
    var variations = {
        digits: /\d/.test(pass),
        lower: /[a-z]/.test(pass),
        upper: /[A-Z]/.test(pass),
        nonWords: /\W/.test(pass),
    }

    variationCount = 0;
    for (var check in variations) {
        variationCount += (variations[check] == true) ? 1 : 0;
    }
    score += (variationCount - 1) * 10;

    return parseInt(score);
}

function checkPassStrength(pass) {
    var score = scorePassword(pass);
    if (score > 80)
        return "strong";
    if (score > 60)
        return "good";
    if (score >= 30)
        return "weak";

    return "";
}

function password_generator( len ) {
            var length = (len)?(len):(10);
            var string = "abcdefghijklmnopqrstuvwxyz"; //to upper 
            var numeric = '0123456789';
            var punctuation = '!@#$%^&*()_+~`|}{[]\:;?><,./-=';
            var password = "";
            var character = "";
            var crunch = true;
            while( password.length<length ) {
                entity1 = Math.ceil(string.length * Math.random()*Math.random());
                entity2 = Math.ceil(numeric.length * Math.random()*Math.random());
                entity3 = Math.ceil(punctuation.length * Math.random()*Math.random());
                hold = string.charAt( entity1 );
                hold = (entity1%2==0)?(hold.toUpperCase()):(hold);
                character += hold;
                character += numeric.charAt( entity2 );
                character += punctuation.charAt( entity3 );
                password = character;
            }
            return password;
        }


$(document).ready(function() {
$('#info').hide();

document.getElementById("copyButton").addEventListener("click", function() {
	console.log('c');
    copyToClipboard(document.getElementById("password"));
    $('#info').html('Copy <strong>"'+$('#password').val()+'"</strong> to clipboard!');
$("#info").show().delay(1000).fadeOut();
});

function copyToClipboard(elem) {
	  // create hidden text element, if it doesn't already exist
    var targetId = "_hiddenCopyText_";
    var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA"|| elem.tagName === "PASSWORD";
    var origSelectionStart, origSelectionEnd;
    console.log(isInput);
    if (isInput) {
        // can just use the original source element for the selection and copy
        target = elem;
        origSelectionStart = elem.selectionStart;
        origSelectionEnd = elem.selectionEnd;
    } else {
        // must use a temporary form element for the selection and copy
        target = document.getElementById(targetId);
        if (!target) {
            var target = document.createElement("textarea");
            target.style.position = "absolute";
            target.style.left = "-9999px";
            target.style.top = "0";
            target.id = targetId;
            document.body.appendChild(target);
        }
        target.textContent = elem.textContent;
    }
    // select the content
    var currentFocus = document.activeElement;
    target.focus();
    target.setSelectionRange(0, target.value.length);
    
    // copy the selection
    var succeed;
    try {
    	  succeed = document.execCommand("copy");
    } catch(e) {
        succeed = false;
    }
    // restore original focus
    if (currentFocus && typeof currentFocus.focus === "function") {
        currentFocus.focus();
    }
    
    if (isInput) {
        // restore prior selection
        elem.setSelectionRange(origSelectionStart, origSelectionEnd);
    } else {
        // clear temporary content
        target.textContent = "";
    }
    console.log('succeed:'+succeed);
    return succeed;
}
var MAX=50;
$("#password").val(password_generator(getRandomInt(1,MAX)));
	fireInput($('#password'));
function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}
$("#password").focus();
    $("#weakbtn").click(function() {
	$("#password").val(password_generator(getRandomInt(1,8)));
	fireInput($('#password'));
    });
    $("#goodbtn").click(function() {
	$("#password").val(password_generator(9));
	fireInput($('#password'));
    });
    $("#strongbtn").click(function() {
	    console.log('strong');
	$("#password").val(password_generator(getRandomInt(10,MAX)));
	fireInput($('#password'));
    });
    function fireInput(elm){
        var pass = elm.val();
	human=checkPassStrength(pass);
        if(human=="strong"){
        $("#strong").toggleClass("glyphicon-unchecked glyphicon-check");
	$("body").css("background","lightgreen");
        }else if(human=="good"){
        $("#good").toggleClass("glyphicon-unchecked glyphicon-check");
	$("body").css("background","lightyellow");
        }else if(human=="weak"){
        $("#weak").toggleClass("glyphicon-unchecked glyphicon-check");
	$("body").css("background","pink");
        }
    }
    $("#password").on("change keypress keyup keydown", function() {
		    fireInput($(this));
        //$("#strength_human").text(checkPassStrength(pass));
        //$("#strength_score").text(scorePassword(pass));
    });
});
</script>
</head>
<body>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- HOW STRENGTH IS MY PASSWORD? -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-2865072968912801"
     data-ad-slot="8053956020"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="container">
  <h2 style="font-size: xx-large;
    font-weight: bolder;text-align: center;">HOW STRENGTH IS MY PASSWORD?</h2>
  <div class="row">
  <div class="col-xs-11" style="padding-right: 0px;">
	  <div class="input-group">
	    <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
	    <!--<input id="password" type="password"  class="form-control input-lg" name="password" placeholder="Password">-->
	    <input id="password" type="text"  class="form-control input-lg" name="password" placeholder="Password">

	  </div>
	  <div class="alert alert-info" role="alert" id="info">
</div>
  </div>
  <div class="col-xs-1" style="padding-right: 0px;
    padding-left: 30px;">
    <button type="button" class="btn btn-primary btn-lg " id="copyButton"><i class="glyphicon glyphicon-copy"></i> </button>
  </div>
  </div>
  <br/>
  <div class="row">
  <div class="col-xs-4">
    <button type="button" class="btn btn-danger btn-lg btn-block" id="weakbtn"><i class="glyphicon glyphicon-unchecked"id="weak"></i> Weak</button></div>
    <div class="col-xs-4">
    <button type="button" class="btn btn-warning btn-lg btn-block" id="goodbtn"><span class="glyphicon glyphicon-unchecked" id="good"> Good</button></div>
    <div class="col-xs-4">
    <button type="button" class="btn btn-success btn-lg btn-block" id="strongbtn"><span class="glyphicon glyphicon-unchecked" id="strong"> Strong</button></div>
  </div>
  <hr/>
  <div style="text-align: center;">
	  Created by <a href="https://twitter.com/vereperrot">Vere Perrot</a><br/>
	  Thanks for <a href="https://jquery.com/">jQuery</a> and <a href="getbootstrap.com/">bootstrap</a> <br/>
Â© Code Bear, 2016 / Version 1.2<br/>
Your password will not be sent over the internet.<br/>
</div>
</div>

</body>
</html>

