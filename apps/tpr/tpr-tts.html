<!--from:https://codepen.io/SteveJRobertson/pen/emGWaR-->
<head>
	<!--
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.95.1/js/materialize.min.js"></script>-->
<script src="js/jquery.min.js"></script>
<script src="js/materialize.min.js"></script>
</head>
<body>
<script>
	function test(t){
	console.log(t);
	console.log(t.attr('src'));
}
$(function(){
  if ('speechSynthesis' in window) {
    speechSynthesis.onvoiceschanged = function() {
      var $voicelist = $('#voices');

      if($voicelist.find('option').length == 0) {
        speechSynthesis.getVoices().forEach(function(voice, index) {
          var $option = $('<option>')
          .val(index)
          .html(voice.name + (voice.default ? ' (default)' :''));

          $voicelist.append($option);
        });

        $voicelist.material_select();
      }
    }
function shuffle(a) {
    var j, x, i;
    for (i = a.length - 1; i > 0; i--) {
        j = Math.floor(Math.random() * (i + 1));
        x = a[i];
        a[i] = a[j];
        a[j] = x;
    }
    return a;
}
var generalBodyMoves=[
"stand up ",
"sit down ",
"walk ",
"stop ",
"turn left ",
"turn right ",
"turn around ",
"walk backwards ",
"jump ",
"hop ",
"bend over ",
"squat ",
"walk %d steps",
"walk %d steps",
"walk %d steps",
"face me",
"face the wall ",
"face the door",
"lift up your right leg ",
"lift up your left leg ",
"lift up your right arm",
"lift up your left arm",
"lower your right arm",
"lower your right leg",
"lower your left leg",
"lower your left arm",
"shake my hand ",
"kiss me on the cheek! ",
"make a fist ",
"clap your hands ",
"snap your fingers ",
"wave "
	];
var facialThings=[
"smile ",
"cough ",
"laugh ",
"cry ",
"sneeze ",
"open your mouth ",
"close your mouth ",
"stick out your tongue ",
"put your tongue back in ",
"wink ",
"blink ",
"wiggle your nose "
	];
var partsOfTheBody=[
"touch your hair",
"touch your forehead",
"touch your eyebrow",
"touch your eyelash",
"touch your eye",
"touch your ear",
"touch your cheek",
"touch your nose",
"touch your lip",
"touch your mouth",
"touch your moustache",
"touch your beard",
"touch your chin",
"touch your throat",
"touch your tooth",
"touch your tongue",
"touch your chest",
"touch your back",
"touch your shoulder",
"touch your belly",
"touch your arm",
"touch your leg",
"touch your thigh",
"touch your shin",
"touch your hand",
"touch your finger",
"touch your thumb",
"touch your knuckle",
"touch your fingernail",
"touch your elbow",
"touch your knee",
"touch your foot",
"touch your ankle",
"touch your toe"
];

  var kitchenTableStuff=[
"cup ",
"plate ",
"bowl ",
"knife ",
"fork ",
"spoon ",
"napkin",
"tissue ",
"dish ",
"big round serving tray ",
"tray you’d serve tea or coffee on ",
"table ",
"chair "
];

var verbs=[
"where is the %s",
"touch the %s",
"show me the %s",
"pick up the %s",
"put down the %s",
"Put the %s there|put the %s back",
"Put the %s there|return the %s",
"drop the %s",
"move the %s",
"give me the %s|take the %s back",
"throw the %s",
"catch the %s",
"turn over the %s",
"flip the %s",
"put the %s on the table",
"put the %s on the chair",
"put the %s under the table",
"put the %s under the chair",
"push the %s",
"pull the %s",
"lift the %s"
];
var kitchenStuff =[
"pan ",
"oven ",
"stove ",
"sink ",
"faucet ",
"counter ",
"cupboard ",
"refrigerator "
];

var basicFoods=[
"flour ",
"sugar ",
"bread ",
"tea leaves ",
"coffee grounds ",
"rice ",
"nuts ",
"yogurt ",
"candy"
];
var drinks_jp=[
"飲み物",
"茶",
"お茶",
"コーヒー",
"牛乳",
"水",
"ジュース",
"ソーダ水",
"ヨーグルト",
"ビール",
"ワイン"
];
var drinks=[
"drink",
"water ",
"milk ",
"juice ",
"soda ",
"yogurt",
"coffee ",
"tea ",
"beer",
"wine",
"green tea "
];
var fruitsVegetables_jp=[
"リンゴ",
"バナナ",
"オレンジ",
"プラム",
"ブドウ",
"イチジク",
"日付",
"レーズン",
"レモン",
"ザクロ",
"スイカ",
"トマト",
"キュウリ",
"ズッキーニ",
"タマネギ",
"ニンジン",
"ナス",
"小さなナス",
"ポテト",
"ニンニク",
"パセリ",
"レタス",
"ブドウの葉",
"セロリ",
"ミント",
"キャベツ"
];
var fruitsVegetables=[
"apple ",
"banana ",
"orange ",
"plum ",
"grapes ",
"fig ",
"dates ",
"raisins ",
"lemon ",
"pomegranate ",
"watermelon ",
"tomato ",
"cucumber ",
"zucchini ",
"onion ",
"carrot ",
"eggplant ",
"small eggplant ",
"potato ",
"garlic ",
"parsley ",
"lettuce ",
"grape leaves ",
"celery ",
"mint ",
"cabbage"
];
var livingRoom=[
"sofa ",
"chair ",
"pillow ",
"coffee table ",
"rug ",
"carpet ",
"cushion ",
"window ",
"curtain ",
"lamp ",
"ceiling light ",
"light switch ",
"electrical plug ",
"phone plug ",
"telephone ",
"telephone cord ",
"television ",
"bookcase "
];
var bedroom=[
"bed",
"sheet",
"pillow",
"blanket",
"dresser",
"closet",
"coat hanger",
"mirror"
];
var bathroom=[
"toilet",
"bathtub",
"toilet paper",
"sink",
"towel",
"shower curtain",
"toothbrush",
"toothpaste",
"comb",
"plunger",
"shampoo",
"deodorant"
];
var householdItems=[
"light bulb",
"hammer",
"screwdriver",
"screw",
"wrench",
"pliers",
"broom",
"mop",
"dustpan",
"sweep the floor ",
"mop the floor ",
"trash can",
"trash bag",
"washing machine",
"dryer",
"iron",
"ironing board",
"clothes pin"
];
var clothing_jp=[
"シャツ",
"パンツ",
"靴",
"コート",
"下着",
"靴下",
"時計",
"セーター",
"帽子",
"ベルト",
"ドレスシャツ",
"ネクタイ",
"ドレス",
"スカート",
"ブラウス"
];
var clothing=[
"shirt ",
"pants ",
"shoes ",
"coat ",
"underwear ",
"socks ",
"watch ",
"sweater ",
"hat ",
"belt ",
"dress shirt ",
"tie ",
"dress ",
"skirt ",
"blouse "
];
var office=[
"office ",
"desk ",
"computer ",
"keyboard ",
"monitor ",
"printer ",
"mouse ",
"printer cable ",
"voltage regular ",
"power cord ",
"disk drive ",
"floppy disk ",
"paper ",
"modem ",
"fax machine ",
"scanner ",
"shredder "
];
var pen=[
"pick up a pen",
"take off the cap ",
"put the cap back on ",
"write a word ",
"sign your name ",
"draw %d line",
"draw %d circles",
"draw %d squares"
	];
var pen_jp=[
"ペンを拾う",
"キャップを脱ぐ",
"キャップを元に戻す",
"言葉を書く",
"あなたの名前を署名",
"%qの行を描く",
"%qの円を描く",
"%qの正方形を描く"
	];
var voiceThings=[
"speak ",
"sing ",
"hum ",
"whisper ",
"shout",
"yell ",
"stop speaking ",
"stop singing",
"stop humming"
	];
var numbers=[
"one",
"two",
"three",
"four",
"five",
"six",
"seven",
"eight",
"nine",
"ten"
	];
var amount_jp=[
"一つ",
"二つ",
"三つ",
"四つ",
"五つ",
"六つ",
"七つ",
"八つ",
"九つ",
"とお"
	];

var partsOfTheBody_jp=[
"髪",
"額",
"眉",
"睫毛",
"目",
"耳",
"頬",
"鼻",
"唇",
"口",
"口髭",
"顎髭",
"顎",
"喉",
"歯",
"舌",
"胸",
"背中",
"肩",
"お腹 ",
"腕",
"足",
"腿",
"脛",
"手",
"指",
"親指",
"ナックル",
"爪",
"肘",
"膝",
"脚",
"足首"
];
    $('#category').change(function(){
    var cat=document.getElementById("category").value;
	    arr=[];
	    current_words=[];
	    index=-1;
	    console.log("you select "+cat);
	  switch(cat){
			  case "move":
			  current_words=generalBodyMoves;
		      buildActionWords(generalBodyMoves);
			  break;
			  case "face":
			  current_words=facialThings;
		      buildActionWords(facialThings);
			  break;
		  case "kitchenTable":
			  current_words=kitchenTableStuff;
		      buildObjectWords(kitchenTableStuff);
		      break;
	          case "body":
			  current_words=partsOfTheBody;
		      buildActionWords(partsOfTheBody);
		      break;
		  case "kitchenStuff":
			  current_words=kitchenStuff;
		      buildObjectWords(kitchenStuff);
		      break;
		case "basicFoods":
			  current_words=basicFoods;
		      buildObjectWords(basicFoods);
		      break;
		case "drinks":
			  current_words=drinks;
		      buildObjectWords(drinks);
		      break;
		case "fruitsVegetables":
			  current_words=fruitsVegetables;
		      buildObjectWords(fruitsVegetables);
		      break;
		case "livingRoom":
			  current_words=livingRoom;
		      buildObjectWords(livingRoom);
		      break;
		case "bedroom":
			  current_words=bedroom;
		      buildObjectWords(bedroom);
		      break;
		case "bathroom":
			  current_words=bathroom;
		      buildObjectWords(bathroom);
		      break;
		case "householdItems":
			  current_words=householdItems;
		      buildObjectWords(householdItems);
		      break;
		case "clothing":
			  current_words=clothing;
		      buildObjectWords(clothing);
		      break;
		case "clothing_jp":
			  current_words=clothing_jp;
		      buildObjectWords(clothing_jp);
		      break;
		case "office":
			  current_words=office;
		      buildObjectWords(office);
		      break;
		case "pen":
			  current_words=pen;
		      buildActionWords(pen);
		      break;
		case "voiceThings":
			  current_words=voiceThings;
		      buildActionWords(voiceThings);
		      break;
		case "body_jp":
			  current_words=partsOfTheBody_jp;
		      buildActionSentence(partsOfTheBody_jp,"あなたの%sに触れます");
		      break;
		case "fruitsVegetables_jp":
			  current_words=fruitsVegetables_jp;
		      buildActionSentence(fruitsVegetables_jp,"%sをください。");
		      break;
		case "drinks_jp":
			  current_words=drinks_jp;
		      buildActionSentence(drinks_jp,"%sを飲んでください。");
		      break;
	  }
    });
/*
	ex. put pen down
	pen is stuff
	verbs=['put %s down'];
*/
function buildObjectWords(stuff){
  console.log("buildObjectWords...");
  shuffle(verbs);
  for(i=0;i<verbs.length;i++){
  	shuffle(stuff);
      for(j=0;j<stuff.length;j++){
	if(verbs[i].indexOf("|")>-1){
		var parts=verbs[i].split("|");
		  arr.push(parts[0].replace("%s",stuff[j]));
		  arr.push(parts[1].replace("%s",stuff[j]));
	}else{
		  arr.push(verbs[i].replace("%s",stuff[j]));
	}
      }
  }
	console.log("arr...");
	if(arr.length>MAX_ARR_SIZE){
	console.log("arr");
	console.log(arr.length);
		arr.splice(MAX_ARR_SIZE, arr.length-MAX_ARR_SIZE);
	console.log(arr.length);
	console.log("arr end");
	}
	//console.log(arr);
}
/*
	ex.
	ar=['pen'];
	sentence='put %s down';
*/
function buildActionSentence(ar,sentence){
	if(sentence.indexOf("%s")>-1){
		for(var i=0;i<ar.length;i++){
		ar[i]=sentence.replace("%s",ar[i]);
		}
	}
	buildActionWords(ar);
}
/*
	ex.
	ar=['touch your face'];
*/
function buildActionWords(ar){
	console.log("buildActionWords...");
	console.log(numbers);
	if(ar.length>MAX_ARR_SIZE){
		ar.splice(MAX_ARR_SIZE, ar.length-MAX_ARR_SIZE);
	}
	var shuffleNum=0;
	var n=0;
	for(var i=0;i<ar.length;i++){
		if(ar[i].indexOf("%d")>-1){
			if(shuffleNum==0){
				shuffle(numbers);
				shuffleNum=1;
			}
			console.log("***"+ar[i]);
			console.log("^^^"+numbers[n]);
			ar[i]=ar[i].replace("%d",numbers[n]);
			n++;
		}
	}
	 shuffle(ar);
	 arr=ar;
	console.log(arr);
}
//arr=generalBodyMoves.concat(facialThings).concat(partsOfTheBody);
    $('#shuffle').click(function(e){
	    $('#index').val('shuffle...');
	    shuffle(arr);
	    index=-1;
	    $('#index').val('shuffled');
	    // Cancel the default action
    e.preventDefault();
    })
    $('#pict').hide();
$(document).on('click','img.learn_img',function(e) {
	var text=$(this).attr('data-word');
	console.log(text);
      var msg = new SpeechSynthesisUtterance();
      var voices = window.speechSynthesis.getVoices();
      msg.voice = voices[$('#voices').val()];
      msg.rate = $('#rate').val() / 10;
      msg.pitch = $('#pitch').val();
      msg.text = text;

      msg.onend = function(e) {
        console.log('Finished in ' + event.elapsedTime + ' seconds.');
      };

      speechSynthesis.speak(msg);
})
var buildCards= function(words,imgNames,list,e) {
    var html=$(list).html().trim();
    if(html.length>0)$(list).html("");
    else{
	for(var j=0;j<words.length;j++){
		var w=words[j].trim();
		var name=imgNames[j].trim();
		html+="<li class=\"collection-item\"><img class=\"learn_img\" data-word='"+w+"' width=240 height=240 src=\"images\\"+name+".jpg\"/></li>";
		$(list).html(html);
	}
    }
    e.preventDefault();
};
    $('#clothing_jp').click(function(e){
	    buildCards(clothing_jp,clothing,'#clothing_li_jp',e);
    })
    $('#clothing').click(function(e){
	    buildCards(clothing,clothing,'#clothing_li',e);
    })
    $('#showpicture').click(function(e){
	    var word="";
	    for(var j=0;j<current_words.length;j++){
	if(arr[index].indexOf(current_words[j])>-1){
		console.log('curr='+current_words[j]);
		word=current_words[j];
		break;
	}
	    }
	      var text =word.trim();//arr[index].trim();
	    $('#pict').attr('src','images\\'+text+'.jpg');
	    $('#pict').show();
		    // Cancel the default action
    e.preventDefault();
    })
    $('#showword').click(function(e){
      var text =arr[index];// $('#message').val();
	    $('#index').val(text);
	    // Cancel the default action
    e.preventDefault();
    })
    $('#playagain').click(function(e){
      var text =arr[index];// $('#message').val();
      var msg = new SpeechSynthesisUtterance();
      var voices = window.speechSynthesis.getVoices();
      msg.voice = voices[$('#voices').val()];
      msg.rate = $('#rate').val() / 10;
      msg.pitch = $('#pitch').val();
      msg.text = text;

      msg.onend = function(e) {
        console.log('Finished in ' + event.elapsedTime + ' seconds.');
      };

      speechSynthesis.speak(msg);
	    // Cancel the default action
    e.preventDefault();
    })
var index=-1;
var arr=[];
var MAX_ARR_SIZE=20;
//inital words
buildActionWords(generalBodyMoves);

    $('#speaktpr').click(function(e){
	    if(index>=arr.length){
		    return;
	    }
	    console.log(index);
      index++;
      console.log(arr.length);
      //var i=Math.floor(Math.random() * arr.length)
      $('#index').val(index+"/"+arr.length)
      var text =arr[index];// $('#message').val();
      if(index==arr.length){
	      text="cool! You complete it.";
      }
	    console.log(text);
      var msg = new SpeechSynthesisUtterance();
      var voices = window.speechSynthesis.getVoices();
      msg.voice = voices[$('#voices').val()];
      msg.rate = $('#rate').val() / 10;
      msg.pitch = $('#pitch').val();
      msg.text = text;

      msg.onend = function(e) {
        console.log('Finished in ' + event.elapsedTime + ' seconds.');
      };

      speechSynthesis.speak(msg);
	    // Cancel the default action
    e.preventDefault();
    })
    $('#speak').click(function(e){
      var text = $('#message').val();
      var msg = new SpeechSynthesisUtterance();
      var voices = window.speechSynthesis.getVoices();
      msg.voice = voices[$('#voices').val()];
      msg.rate = $('#rate').val() / 10;
      msg.pitch = $('#pitch').val();
      msg.text = text;

      msg.onend = function(e) {
        console.log('Finished in ' + event.elapsedTime + ' seconds.');
      };

      speechSynthesis.speak(msg);
	    // Cancel the default action
    e.preventDefault();
    })
  } else {
    $('#modal1').openModal();
  }
});
</script>
<link rel="stylesheet" href="css/materialize.min.css">
<div class="container">
	
  <div class="row">
    <nav>
      <div class="nav-wrapper">
        <div class="col s12">
          <a href="#" class="brand-logo">Text to speech example</a>
        </div>
      </div>
    </nav>
  </div>
  <form class="col s8 offset-s2">
    <div class="row">
      <label>Choose voice</label>
      <select id="voices"></select>
    </div>
    <div class="row">
      <div class="col s6">
        <label>Rate</label>
        <p class="range-field">
          <input type="range" id="rate" min="1" max="100" value="10" />
        </p>
      </div>
      <div class="col s6">
        <label>Pitch</label>
        <p class="range-field">
          <input type="range" id="pitch" min="0" max="2" value="1" />
        </p>
      </div>
      <div class="col s12">
        <p>N.B. Rate and Pitch only work with native voice.</p>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12">
        <textarea id="message" class="materialize-textarea"></textarea>
        <label>Write message</label>
      </div>
    </div>
    <a href="#" id="speak" class="waves-effect waves-light btn">Speak</a>
    <a href="#" id="speaktpr" class="waves-effect waves-light btn">TPR Speak</a>
    <a href="#" id="shuffle" class="waves-effect waves-light btn">Shuffle</a>
        <textarea id="index" class="materialize-textarea"></textarea>
	<br/>
	<h3>HINT</h3>
    <a href="#" id="playagain" class="waves-effect waves-light btn">1. Play again</a>
	<br/>
    <a href="#" id="showpicture" class="waves-effect waves-light btn">2. Show picture</a>
	<br/>
    <img id="pict" width=240 height=240 src="images\dog.jpg"/>
	<br/>
    <a href="#" id="showword" class="waves-effect waves-light btn">3. Show word</a>
  </form>  
  <hr/>
<select id="category" style="display:block !important">
  <option value="move">General body movements</option>
  <option value="face">Facial things</option>
  <option value="body">Parts of the body</option>
  <option value="kitchenTable">*Kitchen table stuff</option>
  <option value="kitchenStuff">*Kitchen stuff</option>
  <option value="basicFoods">*Basic Foods</option>
  <option value="drinks">Drinks</option>
  <option value="fruitsVegetables">Fruits Vegetables</option>
  <option value="livingRoom">Living Room</option>
  <option value="bedroom">Bedroom</option>
  <option value="bathroom">Bathroom</option>
  <option value="householdItems">Household Items</option>
  <option value="clothing">*Clothing</option>
  <option value="office">Office</option> 
  <option value="pen">Things you can do with a pen</option> 
  <option value="voiceThings">Voice things</option> 
  <option value="body_jp">(JP)Parts of the body</option>
  <option value="drinks_jp">(JP)Drinks</option>
  <option value="fruitsVegetables_jp">(JP)Fruits Vegetables</option>
  <option value="clothing_jp">(JP)*Clothing</option>
</select>

  <h3>Learn Words</h3>
  <a href="#" id="generalBodyMoves" class="waves-effect waves-light btn">General body movements</a><br/>
  <a href="#" id="facialThings" class="waves-effect waves-light btn">Facial things</a><br/>
  <a href="#" id="partsOfTheBody" class="waves-effect waves-light btn">Parts of the body</a><br/>
  <a href="#" id="clothing" class="waves-effect waves-light btn">Clothing</a>
  <ul class="collection with-header" id="clothing_li">
  </ul>
  <a href="#" id="clothing_jp" class="waves-effect waves-light btn">(JP)Clothing</a>
  <ul class="collection with-header" id="clothing_li_jp">
  </ul>
  <br/>
</div>

<div id="modal1" class="modal">
  <h4>Speech Synthesis not supported</h4>
  <p>Your browser does not support speech synthesis.</p>
  <p>We recommend you use Google Chrome.</p>
  <div class="action-bar">
    <a href="#" class="waves-effect waves-green btn-flat modal-action modal-close">Close</a>
  </div>
</div>
</body>


