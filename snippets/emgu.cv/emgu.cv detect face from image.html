<html>
	<title>Vere Perrot Snippets</title>
<head>
<meta charset="UTF-8">
<link href='../css/prism.min.css' rel='stylesheet' type='text/css'/>
<script src='../js/jquery-3.3.1.slim.min.js'></script>
<script src='../js/prism.min.js'></script>
<script src='../js/prism-csharp.js'></script>
<script src='../js/snippet.js'></script>
</head>
<body onload="bodyLoad()">
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Vere Perrot Portfolio -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-2865072968912801"
     data-ad-slot="6421778592"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
	<h3>C#在圖片中搜尋人臉，並存檔</h3>
	<input  type="text" value="" id="myInput" style="width: 5px;">
<button onclick="copySnippet()">Copy text</button>
<pre><code class="language-csharp">
//專案按右鍵選管理nuget套件，搜尋emgu.cv並安裝(版本:3.4.1.2976)。
using Emgu.CV;
using Emgu.CV.Structure;
CascadeClassifier _cascadeClassifier = new CascadeClassifier(Application.StartupPath + "\\haarcascade_frontalface_alt2.xml");
private Byte[] DetectFace(Bitmap currentFrame)
        {
            Byte[] result= { };
            Image<Bgr, Byte> img1 = new Image<Bgr, Byte>(currentFrame);
            using (var imageFrame = img1)
            {
                if (imageFrame != null)
                {
                    var grayframe = imageFrame.Convert<Gray, byte>();
                    var faces = _cascadeClassifier.DetectMultiScale(grayframe, 1.1, 10, Size.Empty); //the actual face detection happens here
                    foreach (var face in faces)
                    {
                        Mat myNewMat = new Mat(imageFrame.Mat, face);
                        string thumbPath = Application.StartupPath + "\\test-thumb.jpg";
                        myNewMat.Save(thumbPath);
                        //imageFrame.Save(Application.StartupPath + "\\test.jpg");
                        //faceImage1 = img;

                    }
                }
            }//end of using
            return result;
        }
</code>  
</pre>
</body>
</html>
